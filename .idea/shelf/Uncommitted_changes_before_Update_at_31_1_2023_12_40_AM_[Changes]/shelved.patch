Index: app/src/main/java/com/example/gas4u/UserTrackOrder.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.gas4u;\r\n\r\nimport androidx.annotation.NonNull;\r\n\r\nimport android.content.Intent;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.view.LayoutInflater;\r\nimport android.view.View;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.example.gas4u.databinding.ActivityUsertrackorderBinding;\r\nimport com.example.gas4u.databinding.ActivityUsertrackorderBinding;\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.auth.FirebaseUser;\r\nimport com.google.firebase.firestore.DocumentReference;\r\nimport com.google.firebase.firestore.DocumentSnapshot;\r\nimport com.google.firebase.firestore.FirebaseFirestore;\r\n\r\nimport java.util.Objects;\r\n\r\npublic class UserTrackOrder extends DrawerBaseActivity {\r\n\r\n    ActivityUsertrackorderBinding activityUsertrackorderBinding;\r\n\r\n    //initialize to extract from database (the green one must be exactly same with db)\r\n    private static final String productt = \"Products\";\r\n    private static final String quantityy = \"Quantity\";\r\n    private static final String totalpricee = \"Total price\";\r\n    private static final String Addresss = \"Address\";\r\n    private static final String shipstatus = \"Order Status\";\r\n\r\n    //declaration to read,authenticate from db\r\n    FirebaseAuth fa = FirebaseAuth.getInstance();\r\n    FirebaseFirestore db = FirebaseFirestore.getInstance();\r\n    FirebaseUser user = fa.getCurrentUser();\r\n\r\n    //Take from database (read from Order collection)\r\n    TextView orderid;\r\n    TextView Products;\r\n    TextView Address;\r\n    TextView Quantity;\r\n    TextView Tprice;\r\n    TextView ORDplace;\r\n\r\n    TextView ORDconfirm;\r\n    TextView ORDdelivery;\r\n\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        activityUsertrackorderBinding = ActivityUsertrackorderBinding.inflate(getLayoutInflater());\r\n        setContentView(activityUsertrackorderBinding.getRoot());\r\n        allocateActivityTitle(\"Track Orders\");\r\n\r\n        View view = LayoutInflater.from(this).inflate(R.layout.activity_usertrackorder, null);\r\n\r\n        //orderid = findViewById(R.id.orderid);\r\n        Products = findViewById(R.id.products);\r\n        Address = findViewById(R.id.address);\r\n        Quantity = findViewById(R.id.quantity);\r\n        Tprice = findViewById(R.id.totalprice);\r\n        ORDplace = findViewById(R.id.ordplace);\r\n\r\n        ORDconfirm = findViewById(R.id.ordconfirm);\r\n        ORDdelivery = findViewById(R.id.orddelivery);\r\n\r\n        DocumentReference docRef = db.collection(\"Order\").document(user.getUid());\r\n        docRef.get()\r\n                .addOnSuccessListener(new OnSuccessListener<DocumentSnapshot>() {\r\n                    @Override\r\n                    public void onSuccess(DocumentSnapshot documentSnapshot) {\r\n                        if (documentSnapshot.exists()) {\r\n                            String product = documentSnapshot.getString(productt);\r\n                            String quantity = documentSnapshot.getString(quantityy);\r\n                            String address = documentSnapshot.getString(Addresss);\r\n                            String tprice = documentSnapshot.getString(totalpricee);\r\n                            String shipstat = documentSnapshot.getString(shipstatus);\r\n\r\n                            Products.setText(\"Products: \" + product);\r\n                            Quantity.setText(\"Quantity: \" + quantity);\r\n                            Tprice.setText(\"Total price: \" + tprice);\r\n                            Address.setText(\"Address: \" + address);\r\n\r\n\r\n                            if (Objects.equals(shipstat, \"Ordered\")){\r\n\r\n                                ORDplace.setText(\"Your order has been placed.\");\r\n\r\n                            } else if (Objects.equals(shipstat, \"confirmed\")){\r\n\r\n                                ORDplace.setText(\"Your order has been placed!\");\r\n                                ORDconfirm.setText(\"Your order has been confirmed!\");\r\n\r\n                            } else if (Objects.equals(shipstat, \"shipped\")){\r\n\r\n                                ORDplace.setText(\"Your order has been placed!\");\r\n                                ORDconfirm.setText(\"Your order has been confirmed!\");\r\n                                ORDdelivery.setText(\"Your order is out for delivery!\");\r\n\r\n                            } else {\r\n                                Toast.makeText(UserTrackOrder.this, \"ORDER NOT AVAILABLE!\", Toast.LENGTH_SHORT).show();\r\n                            }\r\n\r\n\r\n                        } else {\r\n                            Toast.makeText(UserTrackOrder.this, \"NO ACTIVE ORDER\", Toast.LENGTH_SHORT).show();\r\n                        }\r\n                    }\r\n\r\n                })\r\n                .addOnFailureListener(new OnFailureListener() {\r\n                    @Override\r\n                    public void onFailure(@NonNull Exception e) {\r\n                        Toast.makeText(UserTrackOrder.this, \"error!\", Toast.LENGTH_SHORT).show();\r\n                    }\r\n                });\r\n\r\n    }\r\n\r\n    public void btnwasap(View v)\r\n    {\r\n        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(\"https://wa.link/4qgpmo\"));\r\n        //Intent intent = new Intent(getBaseContext(), DashboardActivity.class);\r\n        startActivity(intent);\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/gas4u/UserTrackOrder.java b/app/src/main/java/com/example/gas4u/UserTrackOrder.java
--- a/app/src/main/java/com/example/gas4u/UserTrackOrder.java	(revision 8a8f5963872ffe2ddf4654a42604d38a9b670a31)
+++ b/app/src/main/java/com/example/gas4u/UserTrackOrder.java	(date 1675095358076)
@@ -29,7 +29,7 @@
     //initialize to extract from database (the green one must be exactly same with db)
     private static final String productt = "Products";
     private static final String quantityy = "Quantity";
-    private static final String totalpricee = "Total price";
+    private static final String totalpricee = "Total Price";
     private static final String Addresss = "Address";
     private static final String shipstatus = "Order Status";
 
Index: app/src/main/java/com/example/gas4u/OrderDetailsAdminActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.example.gas4u;\r\n\r\nimport androidx.annotation.NonNull;\r\nimport androidx.appcompat.app.AlertDialog;\r\nimport androidx.appcompat.app.AppCompatActivity;\r\nimport androidx.recyclerview.widget.RecyclerView;\r\n\r\nimport android.content.DialogInterface;\r\nimport android.content.Intent;\r\nimport android.graphics.ColorSpace;\r\nimport android.location.Address;\r\nimport android.location.Geocoder;\r\nimport android.net.Uri;\r\nimport android.os.Bundle;\r\nimport android.text.format.DateFormat;\r\nimport android.view.View;\r\nimport android.widget.ImageButton;\r\nimport android.widget.TextView;\r\nimport android.widget.Toast;\r\n\r\nimport com.google.android.gms.tasks.OnFailureListener;\r\nimport com.google.android.gms.tasks.OnSuccessListener;\r\nimport com.google.firebase.auth.FirebaseAuth;\r\nimport com.google.firebase.database.DataSnapshot;\r\nimport com.google.firebase.database.DatabaseError;\r\nimport com.google.firebase.database.DatabaseReference;\r\nimport com.google.firebase.database.FirebaseDatabase;\r\nimport com.google.firebase.database.ValueEventListener;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Calendar;\r\nimport java.util.HashMap;\r\nimport java.util.List;\r\nimport java.util.Locale;\r\n\r\npublic class OrderDetailsAdminActivity extends AppCompatActivity {\r\n\r\n    // view of ui\r\n    private ImageButton backBtn, editBtn, mapBtn;\r\n    private TextView orderIdTv, dateTv, orderStatusTv, emailTv, phoneTv,totalItemsTv, amountTv, addressTv;\r\n    private RecyclerView itemsRv;\r\n\r\n    String orderId, orderBy;\r\n    // open in map the destination\r\n    String sourceLatitude,sourceLongitude, destinationLatitude, destinationLongitude;\r\n\r\n    private FirebaseAuth firebaseAuth;\r\n    private ArrayList<ModelOrderedItem> orderedItemArrayList;\r\n    private AdapterOrderedItem adapterOrderedItem;\r\n    @Override\r\n    protected void onCreate(Bundle savedInstanceState) {\r\n        super.onCreate(savedInstanceState);\r\n        setContentView(R.layout.activity_order_details_admin);\r\n\r\n        // initialize view of ui\r\n        backBtn = findViewById(R.id.backBtn);\r\n        editBtn = findViewById(R.id.editBtn);\r\n        mapBtn = findViewById(R.id.mapBtn);\r\n        orderIdTv = findViewById(R.id.orderIdTv);\r\n        dateTv = findViewById(R.id.dateTv);\r\n        orderStatusTv = findViewById(R.id.orderStatusTv);\r\n        emailTv = findViewById(R.id.emailTv);\r\n        phoneTv = findViewById(R.id.phoneTv);\r\n        totalItemsTv = findViewById(R.id.totalItemsTv);\r\n        amountTv = findViewById(R.id.amountTv);\r\n        addressTv = findViewById(R.id.addressTv);\r\n        itemsRv = findViewById(R.id.itemsRv);\r\n\r\n        // from intent get data\r\n        orderId = getIntent().getStringExtra(\"orderId\");\r\n        orderBy = getIntent().getStringExtra(\"orderBy\");\r\n\r\n        firebaseAuth = FirebaseAuth.getInstance();\r\n        loadMyInfo();\r\n        loadBuyerInfo();\r\n        loadOrderDetails();\r\n        loadOrderedItems();\r\n\r\n        backBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                // back\r\n                onBackPressed();\r\n            }\r\n        });\r\n\r\n        mapBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                openMap();\r\n            }\r\n        });\r\n        editBtn.setOnClickListener(new View.OnClickListener() {\r\n            @Override\r\n            public void onClick(View v) {\r\n                //edit order status\r\n                editOrderStatusDialog();\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    private void editOrderStatusDialog() {\r\n        //options to display in dialog\r\n        final String[] options = {\"In Progress\", \"Completed\", \"Cancelled\"};\r\n\r\n        //dialog\r\n        AlertDialog.Builder builder = new AlertDialog.Builder(this);\r\n        builder.setTitle(\"Edit Order Status\")\r\n                .setItems(options, new DialogInterface.OnClickListener() {\r\n                    @Override\r\n                    public void onClick(DialogInterface dialog, int which) {\r\n                        // handle the click of item\r\n                        String selectedOption = options[which];\r\n                        editOrderStatus(selectedOption);\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void editOrderStatus(String selectedOption) {\r\n\r\n        //setting data to place in firebase db\r\n        HashMap<String, Object> hashMap = new HashMap<>();\r\n        hashMap.put(\"OrderStatus\", \"\" + selectedOption);\r\n\r\n        DatabaseReference ref = FirebaseDatabase.getInstance().getReference(\"Users\");\r\n        ref.child(firebaseAuth.getUid()).child(\"Orders\").child(orderId)\r\n                .updateChildren(hashMap)\r\n                .addOnSuccessListener(new OnSuccessListener<Void>() {\r\n                    @Override\r\n                    public void onSuccess(Void unused) {\r\n\r\n                        //status is update\r\n                        Toast.makeText(OrderDetailsAdminActivity.this, \"Order is now \" + selectedOption, Toast.LENGTH_SHORT).show();\r\n\r\n                    }\r\n                })\r\n                .addOnFailureListener(new OnFailureListener() {\r\n                    @Override\r\n                    public void onFailure(@NonNull Exception e) {\r\n\r\n                        //status fail to update, display reason\r\n                        Toast.makeText(OrderDetailsAdminActivity.this, \"\" + e.getMessage(), Toast.LENGTH_SHORT).show();\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void openMap() {\r\n        //saddr is source address\r\n        //daddr is the destination address\r\n        String address = \"https://maps.google.com/maps?saddr=\" + sourceLatitude + \",\" + sourceLongitude + \"&daddr=\" + destinationLatitude + \",\" + destinationLongitude;\r\n        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(address));\r\n        startActivity(intent);\r\n    }\r\n\r\n    private void loadMyInfo() {\r\n        DatabaseReference ref = FirebaseDatabase.getInstance().getReference(\"Users\");\r\n        ref.child(firebaseAuth.getUid())\r\n                .addValueEventListener(new ValueEventListener() {\r\n                    @Override\r\n                    public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                        sourceLatitude = \"\"+snapshot.child(\"latitude\").getValue();\r\n                        sourceLongitude = \"\"+snapshot.child(\"longitude\").getValue();\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void loadBuyerInfo() {\r\n        DatabaseReference ref = FirebaseDatabase.getInstance().getReference(\"Users\");\r\n        ref.child(orderBy)\r\n                .addValueEventListener(new ValueEventListener() {\r\n                    @Override\r\n                    public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                        //get info of buyer\r\n                        destinationLatitude = \"\"+snapshot.child(\"latitude\").getValue();\r\n                        destinationLongitude = \"\"+snapshot.child(\"longitude\").getValue();\r\n                        String email = \"\"+snapshot.child(\"email\").getValue();\r\n                        String phone = \"\"+snapshot.child(\"phone\").getValue();\r\n\r\n                        // set buyer info\r\n                        emailTv.setText(email);\r\n                        phoneTv.setText(phone);\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void loadOrderDetails(){\r\n        // based on order id, load the the details of order\r\n        DatabaseReference ref = FirebaseDatabase.getInstance().getReference(\"Users\");\r\n        ref.child(firebaseAuth.getUid()).child(\"Orders\").child(orderId)\r\n                .addValueEventListener(new ValueEventListener() {\r\n                    @Override\r\n                    public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                        // get info of the order\r\n                        String orderBy = \"\"+ snapshot.child(\"orderBy\").getValue();\r\n                        String orderCost = \"\"+ snapshot.child(\"orderCost\").getValue();\r\n                        String orderId = \"\"+ snapshot.child(\"orderId\").getValue();\r\n                        String orderStatus = \"\"+ snapshot.child(\"orderStatus\").getValue();\r\n                        String orderTime = \"\"+ snapshot.child(\"orderTime\").getValue();\r\n                        String orderTo = \"\"+ snapshot.child(\"orderTo\").getValue();\r\n                        String latitude = \"\"+ snapshot.child(\"latitude\").getValue();\r\n                        String longitude = \"\"+ snapshot.child(\"longitude\").getValue();\r\n\r\n                        //converting timestamp\r\n                        Calendar calendar = Calendar.getInstance();\r\n                        calendar.setTimeInMillis(Long.parseLong(orderTime));\r\n                        String dateFormated = DateFormat.format(\"dd/MM/yyyy\", calendar).toString();\r\n\r\n                        //status of order\r\n                        if (orderStatus.equals(\"In Progress\")){\r\n                            orderStatusTv.setTextColor(getResources().getColor(R.color.colorPrimary));\r\n                        }\r\n                        else if(orderStatus.equals(\"Completed\")){\r\n                            orderStatusTv.setTextColor(getResources().getColor(R.color.colorGreen));\r\n                        }\r\n                        else if(orderStatus.equals(\"Cancelled\")){\r\n                            orderStatusTv.setTextColor(getResources().getColor(R.color.colorRed));\r\n                        }\r\n\r\n                        //data setting\r\n                        orderIdTv.setText(orderId);\r\n                        orderStatusTv.setText(orderStatus);\r\n                        amountTv.setText(\"RM\"+ orderCost);\r\n                        dateTv.setText(dateFormated);\r\n\r\n                        findAddress(latitude, longitude); // to find the address for delivery\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n    }\r\n\r\n    private void findAddress(String latitude, String longitude) {\r\n        double la = Double.parseDouble(latitude);\r\n        double lo = Double.parseDouble(longitude);\r\n\r\n        Geocoder geocoder;\r\n        List<Address> addresses;\r\n        geocoder = new Geocoder(this, Locale.getDefault());\r\n\r\n        try{\r\n            addresses = geocoder.getFromLocation(la, lo, 1);\r\n\r\n            //the complete address\r\n            String address = addresses.get(0).getAddressLine(0);\r\n            addressTv.setText(address);\r\n        }\r\n        catch (Exception e){\r\n            Toast.makeText(this, \"\"+e.getMessage(), Toast.LENGTH_SHORT).show();\r\n        }\r\n    }\r\n\r\n    private void loadOrderedItems(){\r\n        // loading the products/items of the order\r\n\r\n        //initialize list\r\n        orderedItemArrayList = new ArrayList<>();\r\n\r\n        DatabaseReference ref = FirebaseDatabase.getInstance().getReference(\"Users\");\r\n        ref.child(firebaseAuth.getUid()).child(\"Orders\").child(orderId).child(\"Items\")\r\n                .addValueEventListener(new ValueEventListener() {\r\n                    @Override\r\n                    public void onDataChange(@NonNull DataSnapshot snapshot) {\r\n                        orderedItemArrayList.clear(); // clear the list before data is added\r\n\r\n                        for(DataSnapshot ds: snapshot.getChildren()){\r\n                            ModelOrderedItem modelOrderedItem = ds.getValue(ModelOrderedItem.class);\r\n                            //adding to list\r\n                            orderedItemArrayList.add(modelOrderedItem);\r\n                        }\r\n                        //setting adapter\r\n                        adapterOrderedItem = new AdapterOrderedItem(OrderDetailsAdminActivity.this, orderedItemArrayList);\r\n                        //setting adapter to recyclerView\r\n                        itemsRv.setAdapter(adapterOrderedItem);\r\n\r\n                        //setting total number od products in the order\r\n                        totalItemsTv.setText(\"\"+snapshot.getChildren());\r\n\r\n                    }\r\n\r\n                    @Override\r\n                    public void onCancelled(@NonNull DatabaseError error) {\r\n\r\n                    }\r\n                });\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/example/gas4u/OrderDetailsAdminActivity.java b/app/src/main/java/com/example/gas4u/OrderDetailsAdminActivity.java
--- a/app/src/main/java/com/example/gas4u/OrderDetailsAdminActivity.java	(revision 8a8f5963872ffe2ddf4654a42604d38a9b670a31)
+++ b/app/src/main/java/com/example/gas4u/OrderDetailsAdminActivity.java	(date 1675093747078)
@@ -54,7 +54,7 @@
 
         // initialize view of ui
         backBtn = findViewById(R.id.backBtn);
-        editBtn = findViewById(R.id.editBtn);
+//        editBtn = findViewById(R.id.editBtn);
         mapBtn = findViewById(R.id.mapBtn);
         orderIdTv = findViewById(R.id.orderIdTv);
         dateTv = findViewById(R.id.dateTv);
